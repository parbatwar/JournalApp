@page "/calender-view"
@layout MainLayout

@using JournalApp.Services.EntryService

@inject NavigationManager Nav
@using JournalApp.Services.EntryService
@inject IEntryService EntryService


<div class="page-header">
    <h1>Calendar</h1>
    <p>Select a date to view or write your journal</p>
</div>

<div class="calendar-card">
    <div class="calendar-row">

        <div class="calendar-field">
            <label>Select date</label>
            <input type="date"
                   class="calendar-picker"
                   @bind="selectedDate" />
        </div>

        <button class="go-btn"
                type="button"
                @onclick="GoToEntry">
            Go
        </button>

    </div>
</div>

@code {

    // selected date from calendar
    DateTime selectedDate = DateTime.Today;

    async Task GoToEntry()
    {
        // service le selected date ko entry khojcha (single-user app)
        var entryId = await EntryService.GetEntryIdByDate(selectedDate);

        if (entryId == null)
        {
            await ShowAlert(
                "No Entry",
                "There is no journal entry for this date."
            );
            return;
        }

        // entry cha → detail page
        Nav.NavigateTo($"/entry/{entryId}");
    }

    async Task ShowAlert(string title, string message)
    {
        var page = Application.Current!.Windows[0].Page;
        if (page != null)
        {
            await page.DisplayAlertAsync(title, message, "OK");
        }
    }
}
