@page "/register"
@layout EmptyLayout
@using JournalApp.Models
@inject AppDbContext Db
@inject NavigationManager Nav

<EditForm Model="user" OnValidSubmit="DoRegister">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="register-bg">
        <div class="register-card">

            <div class="avatar">
                <div class="avatar-icon">👤</div>
            </div>

            <div class="field">
                <input class="form-control"
                       placeholder="Full Name"
                       @bind="user.Name" />
            </div>

            <div class="field">
                <input class="form-control"
                       type="email"
                       placeholder="Email"
                       @bind="user.Email" />
            </div>

            <div class="field">
                <input class="form-control"
                       type="password"
                       placeholder="Password"
                       @bind="user.Password" />
            </div>

            <button class="register-btn mt-3" type="submit">
                REGISTER
            </button>

            <p class="mt-3 text-center">
                Already have account?
                <a href="/login">Login</a>
            </p>

        </div>
    </div>
</EditForm>

@code {
    AppUser user = new();

    async Task DoRegister()
    {
        Db.Users.Add(user);
        await Db.SaveChangesAsync();

        Nav.NavigateTo("/login");
    }
}
