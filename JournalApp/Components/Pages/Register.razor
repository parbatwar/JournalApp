@page "/register"
@layout EmptyLayout
@using JournalApp.FormModels
@using JournalApp.Models
@using JournalApp.Services
@inject IUserService UserService
@inject NavigationManager Nav

<EditForm Model="user" OnValidSubmit="DoRegister">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="register-bg">
        <div class="register-card">

            <div class="avatar">
                <div class="avatar-icon">👤</div>
            </div>

            <div class="field">
                <InputText class="form-control"
                           placeholder="Name"
                           @bind-Value="user.Name" />
            </div>

            <div class="field">
                <InputText class="form-control"
                           type="email"
                           placeholder="Email"
                           @bind-Value="user.Email" />
            </div>

            <div class="field">
                <InputText class="form-control"
                           type="password"
                           placeholder="Password"
                           @bind-Value="user.Password" />
            </div>

            <button class="register-btn mt-3 mb-3" type="submit">
                REGISTER
            </button>

            <NavLink href="/login" class="mt-3 text-center text-decoration-none text-white">
                Already have account?
            </NavLink>

        </div>
    </div>
</EditForm>

@code {
    RegisterModel user = new();

    async Task DoRegister()
    {
        var entity = new AppUser
        {
            Name = user.Name,
            Email = user.Email,
            Password = user.Password
        };

        await UserService.RegisterAsync(entity);
        Nav.NavigateTo("/login");
    }
}
