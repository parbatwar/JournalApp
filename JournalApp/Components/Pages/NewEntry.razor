@page "/"
@layout MainLayout
@using JournalApp.Models
@using Microsoft.EntityFrameworkCore
@inject Session Session
@inject NavigationManager Nav
@inject IJSRuntime JS


<div class="page-header">
    <h1>New Journal Entry</h1>
    <p>Write your thoughts and feelings for today</p>
</div>

<div class="content-card">

    <!-- Title -->
    <div class="mb-4">
        <label for="entryTitle" class="form-label">Title</label>
        <input type="text" class="form-control" id="entryTitle" placeholder="Enter a suitable title">
    </div>

    <div class="mb-5">
        <label class="form-label">Your Thoughts</label>
        <div id="quillEditor" style="height:200px;background:white;"></div>
    </div>

    <!-- Primary Mood -->
    <div class="mb-4">
        <p class="section-title">Primary Mood</p>
        <div class="d-flex flex-wrap gap-2">
            <button type="button" class="btn mood-btn" data-mood="happy">😊 Happy</button>
            <button type="button" class="btn mood-btn" data-mood="neutral">😐 Neutral</button>
            <button type="button" class="btn mood-btn" data-mood="sad">😢 Sad</button>
            <button type="button" class="btn mood-btn" data-mood="anxious">😰 Anxious</button>
            <button type="button" class="btn mood-btn" data-mood="calm">😌 Calm</button>
            <button type="button" class="btn mood-btn" data-mood="excited">🤩 Excited</button>
        </div>
    </div>

    <!-- Secondary Mood -->
    <div class="mb-5">
        <p class="section-subtitle">Secondary mood (optional)</p>
        <div class="d-flex flex-wrap gap-2">
            <button type="button" class="btn mood-btn" data-mood-secondary="happy">😊 Happy</button>
            <button type="button" class="btn mood-btn" data-mood-secondary="neutral">😐 Neutral</button>
            <button type="button" class="btn mood-btn" data-mood-secondary="sad">😢 Sad</button>
            <button type="button" class="btn mood-btn" data-mood-secondary="anxious">😰 Anxious</button>
            <button type="button" class="btn mood-btn" data-mood-secondary="calm">😌 Calm</button>
            <button type="button" class="btn mood-btn" data-mood-secondary="excited">🤩 Excited</button>
        </div>
    </div>

    <!-- Tags -->
    <div class="mb-4">
        <p class="section-title">Tags</p>
        <div class="row">
            <div class="col">
                <label for="tagSelect" class="form-label">Select from presets</label>
                <select class="form-select p-2" aria-label="Default select example">
                    <option selected>Open this select menu</option>
                    <option value="1">One</option>
                    <option value="2">Two</option>
                    <option value="3">Three</option>
                </select>
            </div>
            <div class="col mb-4">
                <label for="exampleFormControlInput1" class="form-label">Or create custom tag</label>
                <input type="email" class="form-control" id="exampleFormControlInput1" placeholder="Type and press Enter">
            </div>
        </div>
    </div>

    <!-- Action Button -->
    <div class="d-grid mt-4 mb-5">
        <button type="button" class="btn create-btn" @onclick="SaveEntry">
            Create Entry 🚀
        </button>

    </div>
</div>


@code {

    string title = "";

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await JS.InvokeVoidAsync("initQuill");
        }

        if (Session.CurrentUser == null)
            Nav.NavigateTo("/login");
    }

    async Task SaveEntry()
    {
        // Quill ko formatted HTML content lina
        var htmlContent = await JS.InvokeAsync<string>("getQuillHtml");
    }
}